\setcounter{section}{4}
\setcounter{subsection}{25}
\setcounter{equation}{0}
\textbf{\LARGE dop 25. Метод пpогонки pешения pазностных уpавнений.}

Рассмотрим систему линейных алгебраических уравнений $A y = f$ с трехдиагональной матрицей $A = [a_{ij}]\,:\; a_{ij} = 0 \;\textit{при}\; j > i+1\;\textit{и}\;j < i-1$. В общем случае СЛАУ с трехдиагональной матрицей имеют вид 
\begin{align}
\label{25.1.1}
    a_j y_{j-1} - c_j y_j + b_j y_{j+1} = -f_j, \quad j = 1, 2, \ldots, N - 1,\\
    \label{25.1.2}
    y_0 = \kappa_1 y_1 + \mu_1, \quad y_N = \kappa_2 y_{N-1} + \mu_2.
\end{align}
Для численного решения систем с трехдиагональными матрицами применяется \textbf{метод прогонки}, который представляет собой вариант метода последовательного исключения неизвестных. 

Проведем вывод расчетных формул метода прогонки. Будем искать решение системы \eqref{25.1.1} в виде 
\begin{equation}\label{25.1.3.1}
    y_j = \alpha_{j+1} y_{j+1} + \beta_{j+1}, \quad j = 0, 1, \ldots, N-1,
\end{equation}
где $\alpha_{j+1}, \; \beta_{j+1}$ -- неизвестные пока коэффициенты. Отсюда найдем $y_{j-1} = \alpha_{j} y_{j} + \beta_{j} = \alpha_j \,(\alpha_{j+1} y_{j+1} + \beta_{j+1}) + \beta_j = \alpha_j \,\alpha_{j+1}\,y_{j+1} + (\alpha_j \beta_{j+1} + \beta_j), \quad j = 1,2, \ldots, N-1$.

Подставляя полученные выражения для $y_j, \; y_{j-1}$ в уравнение \eqref{25.1.1}, приходим при $ j = 1,2, \ldots, N-1$ к уравнению
$$
\big[\alpha_{j+1}(a_j \alpha_j - c_j) + b_j \big] y_{j+1} + \big[\beta_{j+1}(a_j \alpha_j - c_j) + a_j \beta_j + f_j \big] = 0.
$$
Последнее уравнение будет выполнено, если коэффициенты $\alpha_{j+1}, \;\beta_{j+1}$ выбрать такими, чтобы выражения в квадратных скобках обращались в нуль. А именно, достаточно положить
\begin{equation}
    \label{25.1.3}
    \alpha_{j+1} = \frac{b_j}{c_j - \alpha_j a_j}, \quad 
    \beta_{j+1} = \frac{a_j \beta_j + f_j}{c_j - \alpha_j a_j}, \quad
    j = 1, 2, \ldots, N-1.
\end{equation}
Для решения уравнений \eqref{25.1.3} необходимо задать начальные значения $\alpha_1, \; \beta_1$. Из первого условия в \eqref{25.1.2} и формулы \eqref{25.1.3.1} имеем 
\begin{equation}
    \label{25.1.4}
    \alpha_1 = \kappa_1,\quad \beta_1 = \mu_1.
\end{equation}
\textbf{Определение:\;} нахождение коэффициентов $\alpha_{j+1}, \; \beta_{j+1}$ по формулам \eqref{25.1.3}, \eqref{25.1.4} называется \textbf{прямой прогонкой}.

После того как прогоночные коэффициенты $\alpha_{j+1}, \; \beta_{j+1}, \; j = 0, 1, \ldots, N-1$, найдены, решение системы \eqref{25.1.1}, \eqref{25.1.2} находится по рекуррентной формуле \eqref{25.1.3.1}, начиная с $j = N-1$. Для начала счета требуется знать $y_N$, которое определяется из уравнений 
$$
y_N = \kappa_2 y_{N-1} + \mu_2, \quad y_{N-1} = \alpha_N y_N + \beta_N.
$$ 
\textbf{Определение:\;} нахождение $y_j$ по формулам
\begin{equation}
    \label{25.1.5}
    \begin{gathered}
        y_j = \alpha_{j+1} y_{j+1} + \beta_{j+1}, \quad j = N-1, \, N-2, \ldots, 0,\\
        y_N = \frac{\kappa_2\beta_N + \mu_2}{1 - \kappa_2 \alpha_N}
    \end{gathered}
\end{equation}
называется \textbf{обратной прогонкой}. Алгоритм решения системы \eqref{25.1.1}, \eqref{25.1.2}, определяемый по формулам \eqref{25.1.3} - \eqref{25.1.5}, называется \textbf{методом прогонки}.

Метод прогонки можно применять, если знаменатели выражений \eqref{25.1.3}, \eqref{25.1.5} не обращаются в нуль. 

\textbf{Утверждение 1:\;} для возможности применения метода прогонки достаточно потребовать, чтобы коэффициенты системы \eqref{25.1.1}, \eqref{25.1.2} удовлетворяли условиям
\begin{align} 
\label{25.1.6}
    a_j \ne 0, \quad b_j \ne 0,\quad &|c_j|\geq|a_j| + |b_j|, \quad j = 1, 2, \ldots, N-1,\\
    \label{25.1.7}
    &|\kappa_1| \leq 1, \quad |\kappa_2| < 1.
\end{align}

$\blacktriangleright\;$ Сначала докажем по индукции, что при условиях \eqref{25.1.6}, \eqref{25.1.7} модули прогоночных коэффициентов $\alpha_j, \; j = 1, \ldots, N-1$, не превосходят единицы. Согласно \eqref{25.1.4}, \eqref{25.1.7} имеем $|\alpha_1| = |\kappa_1| \leq 1$. Предположим, что $|\alpha_j| \leq 1$ для некоторого $j$ и докажем, что $|\alpha_{j+1}| \leq 1$. Из оценок 
$$
|c_j - \alpha_j a_j| \geq \big| |c_j| - |\alpha_j| |a_j|\big| \geq \big||c_j| - |a_j|\big|
$$
и условий \eqref{25.1.6} получаем 
$$
|c_j - \alpha_j a_j| \geq |b_j| > 0,
$$
т.е. знаменатели выражений \eqref{25.1.3} не обращаются в нуль. Более того
$$
|\alpha_{j+1}| = \frac{|b_j|}{|c_j - \alpha_j a_j|} \leq 1.
$$
Следовательно, $|\alpha_j| \leq 1, \; j = 1, 2, \ldots, N$. Далее, учитывая второе из условий \eqref{25.1.7} и то, что $|\alpha_j| \leq 1$, имеем
$$
|1 - \kappa_2 \alpha_N| \geq 1 - |\kappa_2| |\alpha_N| \geq 1 - |\kappa_2| > 0,
$$
т.е. не обращается в нуль и знаменатель в \eqref{25.1.5}. 

Таким образом, при выполнении условий \eqref{25.1.6}, \eqref{25.1.7} система \eqref{25.1.1}-\eqref{25.1.2} эквивалентна системе \eqref{25.1.3}-\eqref{25.1.5}. Поэтому условия \eqref{25.1.6}, \eqref{25.1.7} гарантируют существование и единственность решения системы \eqref{25.1.1}-\eqref{25.1.2} и возможность нахождения этого решения методом прогонки. $\;\blacksquare$

\textbf{Утверждение 2:\;} доказанные неравенства $|\alpha_j| \leq 1, \; j = 1, 2, \ldots, N$, обеспечивают \textbf{устойчивость} счета по рекуррентным формулам \eqref{25.1.5}. 

$\blacktriangleright\;$ Устойчивость счета означает, что погрешность, внесенная на каком-либо шаге вычислений, не будет возрастать при переходе к следующим шагам. Действительно, пусть в формуле \eqref{25.1.5} при $j = j_0 + 1$ вместо $y_{j_0+1}$ вычислена величина $\widetilde{y}_{j_0+1} = y_{j_0+1} + \delta_{j_0+1}$. Тогда на следующем шаге вычислений, т.е. при $j = j_0$ вместо $y_{j_0} = \alpha_{j_0+1}y_{j_0+1} + \beta_{j_0+1}$ получим величину $\widetilde{y}_{j_0} = \alpha_{j_0+1}(\alpha_{j_0+1} + \delta_{j_0+1}) + \beta_{j_0+1}$ и погрешность окажется равной 
$$
\delta_{j_0} = \widetilde{y}_{j_0} - y_{j_0} = \alpha_{j_0+1}\delta_{j_0+1}.
$$
Отсюда получим, что $|\delta_{j_0}| \leq |\alpha_{j_0+1}| |\delta_{j_0+1}| \leq |\delta_{j_0+1}| $, т.е. погрешность не возрастает. $\;\blacksquare$

\textbf{Замечание:} условия \eqref{25.1.6}, \eqref{25.1.7} могут быть заменены на: 
\begin{align*} 
    a_j \ne 0, \quad b_j \ne 0,\quad &|c_j| > |a_j| + |b_j|, \quad j = 1, 2, \ldots, N-1,\\
    &|\kappa_1| \leq 1, \quad |\kappa_2| \leq 1.
\end{align*}

\rule{275pt}{0.5pt} 

\textbf{Матричная прогонка} относится к \textit{прямым методам} решения разностных уравнений. Она применяется к уравнениям, которые можно записать в виде системы векторных уравнений 
\begin{align}
    -C_0 y_0 + B_0 y_1 &= - F_0,\notag \\
    A_i y_{i-1} - C_i y_i + B_i y_{i+1} &= - F_i, \quad i = 1, 2, \ldots, N-1, \label{25.1}\\
    A_N y_{N-1} - C_N y_N &= - F_N,\notag
\end{align}

где $y_i$ -- искомые векторы размерности $M$, $F_i$ -- заданные векторы, $A_i, \; B_i, \; C_i$ -- заданные квадратные матрицы порядка $M$.

\textbf{Алгоритм матричной прогонки}

Пусть задана система уравнений \eqref{25.1}. Формулы матричной прогонки можно получить так же, как и формулы обычной прогонки, однако при их выводе надо учитывать, что коэффициенты уравнения \eqref{25.1} \textit{неперестановочны}. Будем искать решение системы \eqref{25.1} в виде 
\begin{equation}\label{25.6}
    y_i = \alpha_{i+1} y_{i+1} + \beta_{i+1}, \quad i = 0, 1, \ldots, N-1,
\end{equation}

где $\alpha_{i+1}$ -- квадратные матрицы того же порядка $M$, что и порядок матриц $A_i, B_i, C_i$, а $\beta_{i+1}$ -- вектор размерности $M$. Подставляя \eqref{25.6}, а также 
$$y_{i-1} = \alpha_{i} y_{i} + \beta_{i} = \alpha_i \alpha_{i+1} y_{i+1} + (\alpha_i \beta_{i+1} + \beta_i)$$ 
во второе уравнение системы \eqref{25.1}, получаем, что это уравнение будет выполнено, если потребовать 
$$
(A_i \alpha_i - C_i) \alpha_{i+1} + B_{i+1} = 0,
$$
$$
(A_i \alpha_i - C_i) \beta_{i+1} = - (A_i\beta_i + F_i).
$$
Отсюда приходим к следующим рекуррентным соотношениям для определения матриц $\alpha_{i+1}$ и векторов $\beta_{i+1}$:
\begin{align}\label{25.7}
    \alpha_{i+1} &= (C_i - A_i \alpha_i)^{-1} \, B_i,\\
    \label{25.8}
    \beta_{i+1} &= (C_i - A_i \alpha_i)^{-1} \,(A_i \beta_i + F_i).
\end{align}
Здесь $i = 1, 2, \ldots, N-1$. Начальные значения $\alpha_1$ и $\beta_1$ задаются в соответствии с уравнением $-C_0 y_0 + B_0 y_1 = -F_0,$ которое можно переписать в виде $y_0 = C_0^{-1} B_0 y_1 + C_0^{-1}F_0$.
Сопоставляя этот вид с уравнением \eqref{25.6} при $i = 0$, получаем
\begin{equation}\label{25.10}
    \alpha_1 = C_0^{-1}B_0, \quad \beta_1 = C_0^{-1}F_0.
\end{equation}
После того как все коэффициенты $\alpha_i, \beta_i$ найдены, векторы $y_i, \; i = N-1, \,N-2, \,\ldots, 1, 0$ определяются последовательно из уравнения \eqref{25.6}, начиная с $y_{N-1}$. Для начала счета надо знать вектор $y_N$, который определяется из системы двух уравнений 
$$
A_N y_{N-1} - C_N y_N = - F_N, \quad y_{N-1} = \alpha_N y_N + \beta_N.
$$
Отсюда получаем 
\begin{equation}\label{25.11}
    y_N = (C_N - A_N \alpha_N)^{-1} (A_N \beta_N + F_N).
\end{equation}
Объединяя формулы \eqref{25.6} - \eqref{25.8}, \eqref{25.10}, \eqref{25.11}, приходим к следующему алгоритму матричной прогонки для системы \eqref{25.1}: 
\begin{equation}\label{25.12}
    \begin{gathered}
            \alpha_{i+1}  =(C_i - A_i \alpha_i)^{-1} \, B_i, \quad\qquad\quad i = 1,2, \ldots, N-1,\\
    \beta_{i+1} = (C_i - A_i \alpha_i)^{-1} \,(A_i \beta_i + F_i), \quad\quad i = 1,2, \ldots, N,\\
    y_i = \alpha_{i+1} y_{i+1} + \beta_{i+1}, \qquad\; i = N-1, \,N-2, \,\ldots, 1, 0,\\
    \alpha_1  = C_0^{-1}B_0,\qquad
    \beta_1 = C_0^{-1}F_0,\qquad
    y_N = \beta_{N+1}. 
    \end{gathered}
\end{equation}

\textbf{Устойчивость матричной прогонки}

\textbf{Определение:\;}Метод прогонки \eqref{25.12} будем называть \textbf{устойчивым}, если матрицы $C_i - A_i \alpha_i$ имеют обратные и $\|\alpha_i\|\leq 1, \; i = 1, 2, \ldots, N$.

Из устойчивости прогонки следует однозначная разрешимость системы \eqref{25.1}. Условия $\|\alpha_i\|\leq 1$ обеспечивают численную устойчивость.\\

\textbf{Теорема:\;} Пусть $A_i, \; B_i$ -- ненулевые матрицы, $i = 1, 2, \ldots, N-1$, и пусть существуют матрицы $C_i^{-1}, \; i = 0, 1, \ldots, N$. Если выполнены неравенства
\begin{align*}
    \|C_i^{-1} A_i\| + \|C_i^{-1} B_i\| &\leq 1, \quad i = 1, 2, \ldots, N-1,\\
    \|C_0^{-1} B_0\| &\leq 1, \quad \|C_N^{-1} A_N\| < 1,
\end{align*}
то \textbf{матричная прогонка устойчива}.


% -------- source --------
\bigbreak
[\cite[pages 45-47, 411-418]{chm_samarski_gulin}]