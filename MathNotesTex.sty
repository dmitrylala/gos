%% NotesTeX.sty
%% A package modified from NotesTeX.sty from
%%        https://jhep.sissa.it/jhep/help/JHEP_TeXclass.jsp
%% by Aditya Dhumuntarao.
%% ------------------------------- Legal -------------------------------
%% Adity Dhumuntarao does not own the copyright to the original package,
%% jheppub.sty. All modification have been approved by the Jhep Editori-
%% al committee, and permission has been attributed to Aditya to distri-
%% bute freely the modified version of jheppub.sty, known as NotesTeX.sty
%%
%% This work may be distributed and/or modified under the conditions of
%% the LaTeX Project Public License, either version 1.3 of this license
%% or (at your option) any later version. The latest version of this
%% license is in
%%        http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX version
%% 2005/12/01 or later.
%% The Current Maintainer of this work is
%%        Aditya Dhumuntarao <adhumunt@gmail.com>
%% --------------------------------------------------------------------

% ----------------------------------------------------------------------
%           Jhep Master Presets
% ----------------------------------------------------------------------

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{NotesTeX}[2017/03/21 r1]

\gdef\@fpheader{\ }
\gdef\@journal{jhep}

\newif\ifnotoc\notocfalse
\newif\ifemailadd\emailaddfalse
\newif\iftoccontinuous\toccontinuousfalse
% \newif\ifnatbibsort\natbibsorttrue

% \DeclareOption{no-natbib-sort}{\natbibsortfalse}
\ProcessOptions\relax

% ----------------------------------------------------------------------
%           User Top Level Packages: Required
% ----------------------------------------------------------------------

\usepackage{marginnote,sidenotes,fancyhdr,titlesec,geometry}
\usepackage[dvipsnames]{xcolor}
\usepackage[many]{tcolorbox}
\usepackage{arcs}

% ----------------------------------------------------------------------
%                         Colors
% ----------------------------------------------------------------------
%\usepackage{xcolor} % Required for specifying colors by name
\definecolor{ocre}{RGB}{243,102,25} % Define the orange color used for highlighting throughout the book
\definecolor{blue}{RGB}{35,55,255} % Define the orange color used for highlighting throughout the book
\definecolor{grey}{RGB}{235,239,235} % Define the orange color used for highlighting throughout the book
\definecolor{darkblue}{RGB}{25,35,155} % Define the orange color used for highlighting throughout the book
\definecolor{green}{RGB}{45,200,50} % Define the orange color used for highlighting throughout the book
\definecolor{darkgreen}{RGB}{26,111,0} % Define the orange color used for highlighting throughout the book
\definecolor{black}{RGB}{5,5,5}
\definecolor{yellow}{RGB}{255,249,186}
\definecolor{red}{RGB}{255,25,25}
\definecolor{lightpink}{RGB}{255,250,252}
\definecolor{darkpink}{RGB}{255,240,244}
\definecolor{darkorange}{RGB}{207,93,0}



% ----------------------------------------------------------------------
%           User Top Level Packages: Additional & Styling
% ----------------------------------------------------------------------

\usepackage[T1]{fontenc}                            % Font Styling
\usepackage{lmodern,mathrsfs}

\usepackage[shortlabels]{enumitem}

\usepackage{mathtools,amssymb,amsfonts,amsthm,bm}   % Math Presets
\usepackage{array,tabularx,booktabs}                % Table Presets
\usepackage{graphicx,wrapfig,float,caption}         % Figure Presets
\usepackage{setspace,multicol}                      % Text Presets
\usepackage{tikz,physics,cancel}                    % Physics Presets

%\usepackage[thref, thmmarks]{ntheorem}
%\theoremstyle{break}
%\theoremheaderfont{\bfseries}
%\theorembodyfont{\normalfont}
%\theoremseparator{\medskip}
%\theorempreskip{\bigskipamount}


\usepackage[T1,T2A]{fontenc}
\usepackage[english,russian]{babel}
\usepackage{listings}

%----------------- Custom style ------------------------
\lstdefinestyle{customc}{
    belowcaptionskip=1\baselineskip,
    breaklines=true,
    frame=,
    xleftmargin=\parindent,
    language=C,
    showstringspaces=false,
    basicstyle=,
    keywordstyle=\color{green!70!black},
    commentstyle=\color{red},
    identifierstyle=\color{blue},
    stringstyle=\color{orange},
    numbers=left,
    numbersep=6pt,  % номера строк
    tabsize=4,
}

\lstset{escapechar=@,style=customc}

\newcommand{\includecode}[2][c]{\lstinputlisting[caption=#2, escapechar=,
                                style=customc]{#2}}
%-------------------------------------------------------
%\usepackage{fancyvrb}
%\usepackage[noae]{Sweave}

\renewcommand{\rmdefault}{cmr} % Шрифт с засечками
\renewcommand{\sfdefault}{cmss} % Шрифт без засечек
\renewcommand{\ttdefault}{cmtt} % Моноширинный шрифт



%--------------------------------------------------

\graphicspath{{img/}}

\usepackage{setspace}
\usepackage{dashrule}
\usepackage{float}
%\usepackage[centertags]{amsmath}

\usepackage[strict]{changepage}
\usepackage{here}
%\usepackage{MnSymbol}
%\usepackage{fnpct}
\usepackage{xcolor}


\usepackage{lipsum}
\tcbuselibrary{skins,breakable}


%\usepackage[T2A,T1]{fontenc}
%\usepackage[utf8]{inputenc}
%\usepackage[russian,english]{babel}
%\usepackage{newtxtext}
%\usepackage{tempora} % this supports Cyrillic
%\usepackage{newtxmath}

% ----------------------------------------------------------------------
%           User Page Prefrences
% ----------------------------------------------------------------------
\DeclareGraphicsExtensions{.pdf,.png,.jpg}

\geometry{paperheight=845pt,paperwidth=597pt,                   %fix paperwidth and height.
          marginparsep=.02\paperwidth,marginparwidth=.23\paperwidth,
          inner=.05\paperwidth,voffset=-1in,headheight=.02\paperheight,
          headsep=.03\paperheight,footskip=20pt,
          textheight=.84\paperheight,textwidth=.64\paperwidth}

% \pagestyle{fancy}%
% \newlength{\myoddoffset}%
% \setlength{\myoddoffset}{\marginparwidth + \marginparsep}%
% \renewcommand{\sectionmark}[1]{\markboth{#1}{}}%
% \renewcommand{\subsectionmark}[1]{\markright{#1}{}}%

% \fancypagestyle{fancynotes}{%
%   \fancyhf{}%
%   \fancyheadoffset[rh]{\myoddoffset}%
%   \renewcommand{\headrulewidth}{0pt}%
%   \fancyhead[L]{\textsc{\leftmark}}%
%   \fancyhead[R]{\footnotesize \textit{\rightmark}~~~~ \thepage}%
% }%

% \fancypagestyle{fancypart}{%
%   \fancyhf{}%
%   \fancyfootoffset[rh]{\myoddoffset}%
%   \renewcommand{\headrulewidth}{0pt}
%   \fancyfoot[L]{\footnotesize \thepage}%
% }%

\titleformat{\part}[hang]{{\thispagestyle{fancypart}}\Huge\bfseries}{\marginnote{
\begin{tcolorbox}[width=\marginparwidth,height=\marginparwidth/2,colback=black!75!white,colframe=black!75!white,center title,fonttitle=\bfseries\normalsize,title=ГЛАВА,text fill]
  \begin{center}
  {\color{white}\thepart}
  \end{center}
\end{tcolorbox}
}[-1.25in]}{0pt}{\sffamily\Huge\bfseries}

\newenvironment{fullpage}
    {\smallskip\noindent\begin{minipage}
    {\textwidth+\marginparwidth+\marginparsep}\hrule\smallskip\smallskip}
    {\hrule\end{minipage}\vspace{.1in}}


% ----------------------------------------------------------------------
%           User Created Environments
% ----------------------------------------------------------------------


\newtheoremstyle{mystyle}%
  {}%
  {}%
  {\normalfont}% \itshape
  {}%
  {\small\bf\sffamily}%
  {.}%
  { }%
  {}%

\newtheoremstyle{commentstyle}%
  {}%
  {}%
  {\small\bf}%{\normalfont}%
  {}%
  {\sffamily\bfseries}%
  {}%
  { }%
  {}%

\newtheoremstyle{commentstyle2} % non bf
  {}%
  {}%
  {\small}%{\normalfont}%
  {}%
  {\sffamily\bfseries}%
  {}%
  { }%
  {}%

\newtheoremstyle{commentnormalstyle}%
  {}%
  {}%
  {\normalfont}%{\small\bf}
  {}%
  {\sffamily\bfseries}%
  {}%
  { }%
  {}%

\newtheoremstyle{remarkstyle}%
  {}%
  {}%
  {\normalfont}% \itshape
  {}%
  {\itshape\bfseries}%
  {.}%
  { }%
  {}%

% Boxed/framed environments
\newtheoremstyle{ocrenumbox}% Theorem style name
{0pt}% Space above
{0pt}% Space below
{\normalfont}% Body font
{}% Indent amount
{\small\bf\sffamily\color{ocre}}% Theorem head font
{\;}% Punctuation after theorem head
{0.25em}% Space after theorem head
{\small\sffamily\bf\color{black}\thmname{#1}\nobreakspace\thmnumber{\@ifnotempty{#1}{}\@upn{#2}.}% Theorem text (e.g. Theorem 2.1)
\thmnote{\nobreakspace\the\thm@notefont\sffamily\itshape\color{black}(#3).}} % Optional theorem note


% Boxed/framed environments
\newtheoremstyle{queststyle}% Question style name
{0pt}% Space above
{0pt}% Space below
{\bf}% Body font
{}% Indent amount
{\small\bf\sffamily\color{ocre}}% Theorem head font
{\;}% Punctuation after theorem head
{0.25em}% Space after theorem head
{\small\sffamily\bf\color{black}\thmname{#1}\nobreakspace\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}% Theorem text (e.g. Theorem 2.1)
\thmnote{\nobreakspace\the\thm@notefont\sffamily\itshape\color{black}(#3).}} % Optional theorem note


%----------------------------------------------------------------------------------------
%	REMARK ENVIRONMENT
%----------------------------------------------------------------------------------------

\newenvironment{remark}{\par\vspace{10pt}\small % Vertical white space above the remark and smaller font size
\begin{list}{}{
\leftmargin=35pt % Indentation on the left
\rightmargin=25pt}\item\ignorespaces % Indentation on the right
\makebox[-2.5pt]{\begin{tikzpicture}[overlay]
\node[draw=darkgreen,line width=1pt,circle,fill=black!15,font=\sffamily\bfseries,inner sep=2pt,outer sep=0pt] at (-15pt,0pt){\textcolor{darkgreen}{Зам.}};\end{tikzpicture}} % Orange R in a circle
\advance\baselineskip -1pt}{\end{list}\vskip5pt} % Tighter line spacing and white space after remark

\newenvironment{remarknb}{\par\vspace{10pt}\small % Vertical white space above the remark and smaller font size
\begin{list}{}{
\leftmargin=35pt % Indentation on the left
\rightmargin=25pt}\item\ignorespaces % Indentation on the right
\makebox[-2.5pt]{\begin{tikzpicture}[overlay]
\node[draw=darkorange,line width=1.5pt,circle,fill=black!15,font=\sffamily\bfseries,inner sep=2pt,outer sep=0pt] at (-15pt,0pt){\textcolor{black}{NB\,!}};\end{tikzpicture}} % Orange R in a circle
\advance\baselineskip -1pt}{\end{list}\vskip5pt} % Tighter line spacing and white space after remark


\newenvironment{remarknbblue}{\par\vspace{10pt}\small % Vertical white space above the remark and smaller font size
\begin{list}{}{
\leftmargin=35pt % Indentation on the left
\rightmargin=25pt}\item\ignorespaces % Indentation on the right
\makebox[-2.5pt]{\begin{tikzpicture}[overlay]
\node[draw=darkorange,line width=1.5pt,circle,fill=black!15,font=\sffamily\bfseries,inner sep=2pt,outer sep=0pt] at (-15pt,0pt){\textcolor{black}{NB\,!}};\end{tikzpicture}} % Orange R in a circle
\advance\baselineskip -1pt}{\end{list}\vskip5pt} % Tighter line spacing and white space after remark


%----------------------------------------------------------------------------------------
%	QUESTION ENVIRONMENT
%----------------------------------------------------------------------------------------

\newenvironment{question}{\par\vspace{10pt}\bfseries % Vertical white space above the question and smaller font size
\begin{list}{}{
\leftmargin=35pt % Indentation on the left
\rightmargin=25pt}\item\ignorespaces % Indentation on the right
\makebox[-2.5pt]{\begin{tikzpicture}[overlay]
\node[draw=ocre,line width=2pt,circle,fill=black!15,font=\sffamily\bfseries,font=\fontsize{12pt}{12pt}\selectfont,inner sep=4pt,outer sep=2pt] at (-15pt,0pt){\textcolor{black}{?}};\end{tikzpicture}} % Orange R in a circle
\advance\baselineskip -1pt}{\end{list}\vskip5pt} % Tighter line spacing and white space after remark


\renewenvironment{proof}{{\sffamily\bfseries Доказательство. }}{\qed}

\newenvironment{proofocre}{{\sffamily\bfseries Доказательство. }}{\qed}

%\theoremstyle{remarkstyle}{
%  \newtheorem*{remark}{Замечание}
%}

\theoremstyle{mystyle}{
  \newtheorem*{definition}{Определение}%[section]
}

\theoremstyle{mystyle}{
  \newtheorem{definitionnum}{Определение}%[section]
}

\theoremstyle{ocrenumbox}{
  \newtheorem{theorem}{Теорема}%[part]
}

\theoremstyle{ocrenumbox}{
  \newtheorem*{theoremNum}{}%[part]
}

\theoremstyle{ocrenumbox}{
  \newtheorem{proposition}{Утверждение}[section]
}

%\theoremstyle{queststyle}{
%  \newtheorem{question}{.}%[part]
%}

\theoremstyle{mystyle}{
  \newtheorem*{lemma}{Лемма}%[theorem]{Лемма}
}

\theoremstyle{mystyle}{
  \newtheorem{lemmanum}{Лемма}%[theorem]{Лемма}
}

\theoremstyle{remarkstyle}{
  \newtheorem{corollary}{Следствие}%[theorem]
}

\theoremstyle{mystyle}{
  \newtheorem{example}{Пример}[section]
}

\theoremstyle{mystyle}{
  \newtheorem*{exercise}{Упражнение}
}

\theoremstyle{definition}{
    \newtheorem{problem}{Задача}}

\theoremstyle{commentstyle}{
  \newtheorem*{Comment}{}
}

\theoremstyle{commentstyle}{
  \newtheorem*{Commentblue}{}
}

\theoremstyle{commentstyle2}{
  \newtheorem*{Commentblue2}{}
}

\theoremstyle{commentstyle}{
  \newtheorem*{Commentgreen}{}
}

\theoremstyle{commentstyle}{
  \newtheorem*{Commentocre}{}
}

\theoremstyle{commentstyle}{
  \newtheorem*{Commentgrey}{}
}

\theoremstyle{commentstyle2}{
  \newtheorem*{Commentgrey2}{}
}

\theoremstyle{commentnormalstyle}{
  \newtheorem*{Commentgrey3}{}
}

\theoremstyle{commentnormalstyle}{
  \newtheorem*{Commentwhite}{}
}

%----------------------------------------------------------------------------------------
%                               BOX ENIRONMENTS
%----------------------------------------------------------------------------------------


\tcolorboxenvironment{definition}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!96!Cerulean},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{Cerulean},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{definitionnum}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!96!Cerulean},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{Cerulean},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{theorem}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{Dandelion},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{theoremNum}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{Dandelion},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}


\tcolorboxenvironment{proposition}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{Dandelion},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{corollary}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{Black},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{Comment}{
  %\footnotesize
  boxrule=0pt,
  boxsep=2pt,
  %colback=White
  colback={grey},
    %blanker,
  enhanced jigsaw,
  %borderline west={2pt}{0pt}{Dandelion},
  borderline west={1pt}{0pt}{black},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{Commentblue}{
  %\footnotesize
  boxrule=0pt,
  boxsep=2pt,
  %colback=White
  colback={White!96!Cerulean},
    %blanker,
  enhanced jigsaw,
  %borderline west={2pt}{0pt}{Dandelion},
  borderline west={1pt}{0pt}{black},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{Commentblue2}{
  %\footnotesize
  boxrule=0pt,
  boxsep=2pt,
  %colback=White
  colback={White!96!Cerulean},
    %blanker,
  enhanced jigsaw,
  %borderline west={2pt}{0pt}{Dandelion},
  borderline west={1pt}{0pt}{White!90!Cerulean},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{Commentgreen}{
  %\footnotesize
  boxrule=0pt,
  boxsep=2pt,
  %colback=White
  colback={White!80!darkgreen},
    %blanker,
  enhanced jigsaw,
  %borderline west={2pt}{0pt}{Dandelion},
  borderline west={1pt}{0pt}{black},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{Commentocre}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{Dandelion},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{Commentgrey}{
  boxrule=0pt,
  boxsep=2pt,
  colback={grey!40},
  borderline west={1pt}{0pt}{NavyBlue!80!white},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{Commentgrey2}{
  boxrule=0pt,
  boxsep=2pt,
  colback={grey!60},
  borderline west={1pt}{0pt}{grey!60},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{Commentgrey3}{
  boxrule=0pt,
  boxsep=2pt,
  colback={grey!60},
  borderline west={1pt}{0pt}{grey!60},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{Commentwhite}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White},
  borderline west={0pt}{0pt}{White},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}


\tcolorboxenvironment{lemma}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{darkblue},
  before skip=10pt,
  after skip=10pt,
  sharp corners,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{lemmanum}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{darkblue},
  before skip=10pt,
  after skip=10pt,
  sharp corners,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{problem}{
  boxrule=0pt,
  boxsep=2pt,
  colback={lightpink},
  enhanced jigsaw,
  borderline west={1pt}{0pt}{red},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  breakable,
}

\tcolorboxenvironment{proof}{
  boxrule=0pt,
  boxsep=2pt,
  colback={grey!25},
  borderline west={1pt}{0pt}{NavyBlue!80!white},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{proofocre}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!93!Dandelion},
  borderline west={1pt}{0pt}{White!80!Dandelion},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{remark}{
  boxrule=0pt,
  boxsep=2pt,
  blanker,
  borderline west={2pt}{0pt}{white},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{remarknb}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!70!Dandelion},
  borderline west={2pt}{0pt}{white},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{remarknbblue}{
  boxrule=0pt,
  boxsep=2pt,
  colback={White!95!Cerulean},
  borderline west={2pt}{0pt}{white},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{question}{
  boxrule=0pt,
  boxsep=2pt,
  colback={grey},
  borderline west={2pt}{0pt}{white},
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{example}{
  boxrule=0pt,
  boxsep=2pt,
  blanker,
  borderline west={2pt}{0pt}{darkblue},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}

\tcolorboxenvironment{exercise}{
  boxrule=0pt,
  boxsep=2pt,
  blanker,
  borderline west={2pt}{0pt}{darkblue},
  sharp corners,
  before skip=10pt,
  after skip=10pt,
  left=12pt,
  right=12pt,
  breakable,
}




%===============================================================================

\@addtoreset{problem}{section} % Счетчик задач
\@addtoreset{example}{section} % Счетчик примеров
\@addtoreset{corollary}{theorem} % Счетчик примеров
%\@addtoreset{proposition}{section} % Счетчик утверждений

%===============================================================================



\renewcommand*{\raggedleftmarginnote}{\noindent}
\renewcommand*{\raggedrightmarginnote}{\noindent}
\newcommand{\mn}[1]{\textsuperscript{\thesidenote}{}\marginnote{\textsuperscript{\thesidenote}{}~\itshape\footnotesize #1}\refstepcounter{sidenote}}
\newcommand{\en}[1]{\marginnote{\footnotesize #1}}
\newcommand{\sn}[1]{\sidenote{\itshape\footnotesize #1}}



% ----------------------------------------------------------------------
%           User Created Commands
% ----------------------------------------------------------------------

\newcommand*\widefbox[1]{\fbox{\hspace{2em}#1\hspace{2em}}}
\newcommand{\xint}{\int_{x_1}^{x_2}}
\newcommand{\tint}{\int_{t_1}^{t_2}}
\newcommand{\mw}{\sqrt{m\omega}}
\newcommand{\de}{\delta}
\newcommand{\dde}{\dot{\delta}}
\newcommand{\di}{\delta_i}
\newcommand{\ddi}{\dot{\delta_i}}
\newcommand{\dddi}{\ddot{\delta_i}}
\newcommand{\dipl}{\delta_{i+1}}
\newcommand{\dimi}{\delta_{i-1}}
\newcommand{\ddt}[1]{\frac{{d} #1}{dt}}
\newcommand{\ddtt}[1]{\frac{d^2 #1}{dt^2}}
\newcommand{\ddx}[1]{\frac{d #1}{dx}}
\newcommand{\ddxx}[1]{\frac{d^2 #1}{dx^2}}
\newcommand{\eps}{\epsilon}
\newcommand{\del}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\deltwo}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\lam}{\lambda}
\newcommand{\Lam}{\Lambda}
\newcommand{\sig}{\sigma}
\newcommand{\Sig}{\Sigma}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\munu}{{\mu\nu}}
\newcommand{\thalf}{\tfrac{1}{2}}

\newcommand{\bfA}{{\bf A}}
\newcommand{\bfB}{{\bf B}}
\newcommand{\bfC}{{\bf C}}
\newcommand{\bfD}{{\bf D}}
\newcommand{\bfE}{{\bf E}}
\newcommand{\bfF}{{\bf F}}
\newcommand{\bfG}{{\bf G}}
\newcommand{\bfH}{{\bf H}}
\newcommand{\bfI}{{\bf I}}
\newcommand{\bfJ}{{\bf J}}
\newcommand{\bfK}{{\bf K}}
\newcommand{\bfL}{{\bf L}}
\newcommand{\bfM}{{\bf M}}
\newcommand{\bfN}{{\bf N}}
\newcommand{\bfO}{{\bf O}}
\newcommand{\bfP}{{\bf P}}
\newcommand{\bfQ}{{\bf Q}}
\newcommand{\bfR}{{\bf R}}
\newcommand{\bfS}{{\bf S}}
\newcommand{\bfT}{{\bf T}}
\newcommand{\bfU}{{\bf U}}
\newcommand{\bfV}{{\bf V}}
\newcommand{\bfW}{{\bf W}}
\newcommand{\bfX}{{\bf X}}
\newcommand{\bfY}{{\bf Y}}
\newcommand{\bfZ}{{\bf Z}}

\newcommand{\bfa}{{\bf a}}
\newcommand{\bfb}{{\bf b}}
\newcommand{\bfc}{{\bf c}}
\newcommand{\bfd}{{\bf d}}
\newcommand{\bfe}{{\bf e}}
\newcommand{\bff}{{\bf f}}
\newcommand{\bfg}{{\bf g}}
\newcommand{\bfh}{{\bf h}}
\newcommand{\bfi}{{\bf i}}
\newcommand{\bfj}{{\bf j}}
\newcommand{\bfk}{{\bf k}}
\newcommand{\bfl}{{\bf l}}
\newcommand{\bfm}{{\bf m}}
\newcommand{\bfn}{{\bf n}}
\newcommand{\bfo}{{\bf o}}
\newcommand{\bfp}{{\bf p}}
\newcommand{\bfq}{{\bf q}}
\newcommand{\bfr}{{\bf r}}
\newcommand{\bfs}{{\bf s}}
\newcommand{\bft}{{\bf t}}
\newcommand{\bfu}{{\bf u}}
\newcommand{\bfv}{{\bf v}}
\newcommand{\bfw}{{\bf w}}
\newcommand{\bfx}{{\bf x}}
\newcommand{\bfy}{{\bf y}}
\newcommand{\bfz}{{\bf z}}

\newcommand{\mcA}{{\mathcal{A}}}
\newcommand{\mcB}{{\mathcal{B}}}
\newcommand{\mcC}{{\mathcal{C}}}
\newcommand{\mcD}{{\mathcal{D}}}
\newcommand{\mcE}{{\mathcal{E}}}
\newcommand{\mcF}{{\mathcal{F}}}
\newcommand{\mcG}{{\mathcal{G}}}
\newcommand{\mcH}{{\mathcal{H}}}
\newcommand{\mcI}{{\mathcal{I}}}
\newcommand{\mcJ}{{\mathcal{J}}}
\newcommand{\mcK}{{\mathcal{K}}}
\newcommand{\mcL}{{\mathcal{L}}}
\newcommand{\mcM}{{\mathcal{M}}}
\newcommand{\mcN}{{\mathcal{N}}}
\newcommand{\mcO}{{\mathcal{O}}}
\newcommand{\mcP}{{\mathcal{P}}}
\newcommand{\mcQ}{{\mathcal{Q}}}
\newcommand{\mcR}{{\mathcal{R}}}
\newcommand{\mcS}{{\mathcal{S}}}
\newcommand{\mcT}{{\mathcal{T}}}
\newcommand{\mcU}{{\mathcal{U}}}
\newcommand{\mcV}{{\mathcal{V}}}
\newcommand{\mcW}{{\mathcal{W}}}
\newcommand{\mcX}{{\mathcal{X}}}
\newcommand{\mcY}{{\mathcal{Y}}}
\newcommand{\mcZ}{{\mathcal{Z}}}

\newcommand{\bbA}{{\mathbb{A}}}
\newcommand{\bbB}{{\mathbb{B}}}
\newcommand{\bbC}{{\mathbb{C}}}
\newcommand{\bbD}{{\mathbb{D}}}
\newcommand{\bbE}{{\mathbb{E}}}
\newcommand{\bbF}{{\mathbb{F}}}
\newcommand{\bbG}{{\mathbb{G}}}
\newcommand{\bbH}{{\mathbb{H}}}
\newcommand{\bbI}{{\mathbb{I}}}
\newcommand{\bbJ}{{\mathbb{J}}}
\newcommand{\bbK}{{\mathbb{K}}}
\newcommand{\bbL}{{\mathbb{L}}}
\newcommand{\bbM}{{\mathbb{M}}}
\newcommand{\bbN}{{\mathbb{N}}}
\newcommand{\bbO}{{\mathbb{O}}}
\newcommand{\bbP}{{\mathbb{P}}}
\newcommand{\bbQ}{{\mathbb{Q}}}
\newcommand{\bbR}{{\mathbb{R}}}
\newcommand{\bbS}{{\mathbb{S}}}
\newcommand{\bbT}{{\mathbb{T}}}
\newcommand{\bbU}{{\mathbb{U}}}
\newcommand{\bbV}{{\mathbb{V}}}
\newcommand{\bbW}{{\mathbb{W}}}
\newcommand{\bbX}{{\mathbb{X}}}
\newcommand{\bbY}{{\mathbb{Y}}}
\newcommand{\bbZ}{{\mathbb{Z}}}

\newcommand{\mfa}{{\mathfrak{a}}}
\newcommand{\mfb}{{\mathfrak{b}}}
\newcommand{\mfc}{{\mathfrak{c}}}
\newcommand{\mfd}{{\mathfrak{d}}}
\newcommand{\mfe}{{\mathfrak{e}}}
\newcommand{\mff}{{\mathfrak{f}}}
\newcommand{\mfg}{{\mathfrak{g}}}
\newcommand{\mfh}{{\mathfrak{h}}}
\newcommand{\mfi}{{\mathfrak{i}}}
\newcommand{\mfj}{{\mathfrak{j}}}
\newcommand{\mfk}{{\mathfrak{k}}}
\newcommand{\mfl}{{\mathfrak{l}}}
\newcommand{\mfm}{{\mathfrak{m}}}
\newcommand{\mfn}{{\mathfrak{n}}}
\newcommand{\mfo}{{\mathfrak{o}}}
\newcommand{\mfp}{{\mathfrak{p}}}
\newcommand{\mfq}{{\mathfrak{q}}}
\newcommand{\mfr}{{\mathfrak{r}}}
\newcommand{\mfs}{{\mathfrak{s}}}
\newcommand{\mft}{{\mathfrak{t}}}
\newcommand{\mfu}{{\mathfrak{u}}}
\newcommand{\mfv}{{\mathfrak{v}}}
\newcommand{\mfw}{{\mathfrak{w}}}
\newcommand{\mfx}{{\mathfrak{x}}}
\newcommand{\mfy}{{\mathfrak{y}}}
\newcommand{\mfz}{{\mathfrak{z}}}

\newcommand{\mfA}{{\mathfrak{A}}}
\newcommand{\mfB}{{\mathfrak{B}}}
\newcommand{\mfC}{{\mathfrak{C}}}
\newcommand{\mfD}{{\mathfrak{D}}}
\newcommand{\mfE}{{\mathfrak{E}}}
\newcommand{\mfF}{{\mathfrak{F}}}
\newcommand{\mfG}{{\mathfrak{G}}}
\newcommand{\mfH}{{\mathfrak{H}}}
\newcommand{\mfI}{{\mathfrak{I}}}
\newcommand{\mfJ}{{\mathfrak{J}}}
\newcommand{\mfK}{{\mathfrak{K}}}
\newcommand{\mfL}{{\mathfrak{L}}}
\newcommand{\mfM}{{\mathfrak{M}}}
\newcommand{\mfN}{{\mathfrak{N}}}
\newcommand{\mfO}{{\mathfrak{O}}}
\newcommand{\mfP}{{\mathfrak{P}}}
\newcommand{\mfQ}{{\mathfrak{Q}}}
\newcommand{\mfR}{{\mathfrak{R}}}
\newcommand{\mfS}{{\mathfrak{S}}}
\newcommand{\mfT}{{\mathfrak{T}}}
\newcommand{\mfU}{{\mathfrak{U}}}
\newcommand{\mfV}{{\mathfrak{V}}}
\newcommand{\mfW}{{\mathfrak{W}}}
\newcommand{\mfX}{{\mathfrak{X}}}
\newcommand{\mfY}{{\mathfrak{Y}}}
\newcommand{\mfZ}{{\mathfrak{Z}}}

%-----------------------------------------------------------------------
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}}
\newcommand{\veps}{\varepsilon}
\newcommand{\vphi}{\varphi}
\newcommand{\intl}{\int\limits}
\newcommand{\suml}{\sum\limits}
\newcommand{\supl}{\sup\limits}
\newcommand{\infl}{\inf\limits}
\newcommand{\fpfx}{\frac{\partial f}{\partial x}}
\newcommand{\fpfy}{\frac{\partial f}{\partial y}}
\newcommand{\dfpfx}{\dfrac{\partial f}{\partial x}}
\newcommand{\dfpfy}{\dfrac{\partial f}{\partial y}}
\newcommand{\fpzx}{\frac{\partial z}{\partial x}}
\newcommand{\fpzy}{\frac{\partial z}{\partial y}}
\newcommand{\dfpzx}{\dfrac{\partial z}{\partial x}}
\newcommand{\dfpzy}{\dfrac{\partial z}{\partial y}}
%-----------------------------------------------------------------------

%===========================================================================================================


% \ifnatbibsort\RequirePackage[numbers,sort&compress]{natbib}\else\RequirePackage[numbers,compress]{natbib}\fi
\RequirePackage{color}
\RequirePackage[colorlinks=true
,urlcolor=blue
,anchorcolor=blue
,citecolor=blue
,filecolor=blue
,linkcolor=blue
,menucolor=blue
,linktocpage=true
,pdfproducer=medialab
,pdfa=true
]{hyperref}

% \hypersetup{
%     colorlinks=true,
%     linkcolor=blue,
%     citecolor=magenta,
%     filecolor=magenta,      
%     urlcolor=cyan,
%     pdftitle={Overleaf Example},
%     pdfpagemode=FullScreen,
% }

\def\@subheader{\@empty}
\def\@keywords{\@empty}
\def\@abstract{\@empty}
\def\@xtum{\@empty}
\def\@dedicated{\@empty}
\def\@arxivnumber{\@empty}
\def\@collaboration{\@empty}
\def\@collaborationImg{\@empty}
\def\@proceeding{\@empty}
\def\@preprint{\@empty}

\newcommand{\subheader}[1]{\gdef\@subheader{#1}}
\newcommand{\keywords}[1]{\if!\@keywords!\gdef\@keywords{#1}\else%
\PackageWarningNoLine{\jname}{Keywords already defined.\MessageBreak Ignoring last definition.}\fi}
\renewcommand{\abstract}[1]{\gdef\@abstract{#1}}
\newcommand{\dedicated}[1]{\gdef\@dedicated{#1}}
\newcommand{\arxivnumber}[1]{\gdef\@arxivnumber{#1}}
\newcommand{\proceeding}[1]{\gdef\@proceeding{#1}}
\newcommand{\xtumfont}[1]{\textsc{#1}}
\newcommand{\correctionref}[3]{\gdef\@xtum{\xtumfont{#1} \href{#2}{#3}}}
\newcommand\jname{JHEP}
\newcommand\acknowledgments{\section*{Acknowledgments}}
\newcommand\notoc{\notoctrue}
\newcommand\preprint[1]{\gdef\@preprint{\hfill #1}}



%Equivalent to ``\footnote'', but can be used inside the \author macro
% because it does not write the footnote mark
% it has an optional argument that will be used as footnote mark when given
% WARNING: when the optional argument is used, the footnotecounter is not increased
% WARNING: the character ``!'' cannot be used.
% If you really need it use somthing like [\relax !] as the optional arg.
\newcommand\note[2][]{%
\if!#1!%
\stepcounter{footnote}\footnotetext{#2}%
\else%
{\renewcommand\thefootnote{#1}%
\footnotetext{#2}}%
\fi}



%Use this if you want to try to keep some piece of the abstract on a
%very long first page
\newcommand\compress{%
\renewcommand\afterProceedingsSpace{\bigskip}%
\renewcommand\afterTitleSpace{\bigskip}%
\renewcommand\afterRuleSpace{\bigskip\bigskip}
\renewcommand\afterEmailSpace{\par\bigskip}}

%authors and affiliations
\newtoks\auth@toks
\renewcommand{\author}[2][]{%
  \if!#1!%
    \auth@toks=\expandafter{\the\auth@toks#2\ }%
  \else
    \auth@toks=\expandafter{\the\auth@toks#2$^{#1}$\ }%
  \fi
}

\newtoks\affil@toks\newif\ifaffil\affilfalse
\newcommand{\affiliation}[2][]{%
\affiltrue
  \if!#1!%
    \affil@toks=\expandafter{\the\affil@toks{\item[]#2}}%
  \else
    \affil@toks=\expandafter{\the\affil@toks{\item[$^{#1}$]#2}}%
  \fi
}

%emails
%automatically put a comma between emails
\newtoks\email@toks\newcounter{email@counter}%
\setcounter{email@counter}{0}%
\newcommand{\emailAdd}[1]{%
\emailaddtrue%
\ifnum\theemail@counter>0\email@toks=\expandafter{\the\email@toks, \@email{#1}}%
\else\email@toks=\expandafter{\the\email@toks\@email{#1}}%
\fi\stepcounter{email@counter}}
\newcommand{\@email}[1]{\href{mailto:#1}{\tt #1}}


% Collaboration macros
\newcommand*\collaboration[1]{\gdef\@collaboration{#1}}
\newcommand*\collaborationImg[2][]{\gdef\@collaborationImg{#2}}

%all pieces get a ``after'' spacing
\newcommand\afterLogoSpace{\smallskip}
\newcommand\afterSubheaderSpace{\vskip3pt plus 2pt minus 1pt}
\newcommand\afterProceedingsSpace{\vskip21pt plus0.4fil minus15pt}
\newcommand\afterTitleSpace{\vskip23pt plus0.06fil minus13pt}
\newcommand\afterRuleSpace{\vskip23pt plus0.06fil minus13pt}
\newcommand\afterCollaborationSpace{\vskip3pt plus 2pt minus 1pt}
\newcommand\afterCollaborationImgSpace{\vskip3pt plus 2pt minus 1pt}
\newcommand\afterAuthorSpace{\vskip5pt plus4pt minus4pt}
\newcommand\afterAffiliationSpace{\vskip3pt plus3pt}
\newcommand\afterEmailSpace{\vskip16pt plus9pt minus10pt\filbreak}
\newcommand\afterXtumSpace{\par\bigskip}
\newcommand\afterAbstractSpace{\vskip16pt plus9pt minus13pt}
\newcommand\afterKeywordsSpace{\vskip16pt plus9pt minus13pt}
\newcommand\afterArxivSpace{\vskip3pt plus0.01fil minus10pt}
\newcommand\afterDedicatedSpace{\vskip0pt plus0.01fil}
\newcommand\afterTocSpace{\bigskip\medskip}
\newcommand\afterTocRuleSpace{\bigskip\bigskip}
%this is the ``itemsep'' of the affiliations list
\newlength{\affiliationsSep}\setlength{\affiliationsSep}{-3pt}
%this hook is needed if the toc starts on the first page
\newcommand\beforetochook{\pagestyle{myplain}\pagenumbering{roman}}

\DeclareFixedFont\trfont{OT1}{phv}{b}{sc}{11}

%first page
\renewcommand\maketitle{
%% First page
\pagestyle{empty}
\thispagestyle{titlepage}
\newgeometry{marginparwidth=0pt,marginparsep=0pt,textwidth=.9\paperwidth,hoffset=0in,voffset=0in}
\setcounter{page}{0}
\noindent{\small\scshape\@fpheader}\@preprint\par
\afterLogoSpace
% Subheader
\if!\@subheader!\else\noindent{\trfont{\@subheader}}\fi
\afterSubheaderSpace
% Proceedings
\if!\@proceeding!\else\noindent{\sc\@proceeding}\fi
\afterProceedingsSpace
% Title
{\LARGE\flushleft\sffamily\bfseries\@title\par}
\afterTitleSpace
% Rule
\hrule height 1.5\p@%
\afterRuleSpace
% Collaboration
\if!\@collaboration!\else
{\Large\bfseries\sffamily\raggedright\@collaboration}\par
\afterCollaborationSpace
\fi
%
\if!\@collaborationImg!\else
{\normalsize\bfseries\sffamily\raggedright\@collaborationImg}\par
\afterCollaborationImgSpace
%% I leave the size and font so that if there are two collaboration
%% they can be linked with an 'and'
\fi
% Author
{\bfseries\raggedright\sffamily\the\auth@toks\par}
\afterAuthorSpace
% Affiliation
\ifaffil\begin{list}{}{%
\setlength{\leftmargin}{0.28cm}%
\setlength{\labelsep}{0pt}%
\setlength{\itemsep}{\affiliationsSep}%
\setlength{\topsep}{-\parskip}}
\itshape\small%
\the\affil@toks
\end{list}\fi
\afterAffiliationSpace
% E-mail
\ifemailadd %% if emailadd is true
\noindent\hspace{0.28cm}\begin{minipage}[l]{.9\textwidth}
\begin{flushleft}
\textit{E-mail:} \the\email@toks
\end{flushleft}
\end{minipage}
\else %% if emailaddfalse do nothing
\PackageWarningNoLine{\jname}{E-mails are missing.\MessageBreak Plese use \protect\emailAdd\space macro to provide e-mails.}
\fi
\afterEmailSpace
%Erratum or addendum
\if!\@xtum!\else\noindent{\@xtum}\afterXtumSpace\fi
% Abstract
\if!\@abstract!\else\noindent{\renewcommand\baselinestretch{.9}\textsc{Abstract:}}\ \@abstract\afterAbstractSpace\fi
% Keywords
\if!\@keywords!\else\noindent{\textsc{Keywords:}} \@keywords\afterKeywordsSpace\fi
% Arxivnumber
\if!\@arxivnumber!\else\noindent{\textsc{ArXiv ePrint:}} \href{http://arxiv.org/abs/\@arxivnumber}{\@arxivnumber}\afterArxivSpace\fi
% Dedication
\if!\@dedicated!\else\vbox{\small\it\raggedleft\@dedicated}\afterDedicatedSpace\fi
%
\ifnotoc\else
\iftoccontinuous\else\newpage\fi
\beforetochook\hrule
{\tableofcontents}
\afterTocSpace
\hrule
\afterTocRuleSpace
\fi
\setcounter{footnote}{0}
\restoregeometry
\pagestyle{myplain}\pagenumbering{arabic}
} % close the \renewcommand\maketitle{


% Page layout
\renewcommand{\baselinestretch}{1.15}\normalsize
\setlength\lineskip{1\p@}
\setlength\parindent{1.2\parindent}
\setlength\normallineskip{1\p@}
\setlength\parskip{0\p@ \@plus \p@}
\@lowpenalty   51
\@medpenalty  151
\@highpenalty 301
\widowpenalty 1000
\clubpenalty 1000

\setcounter{topnumber}{4}
\renewcommand\topfraction{1}
\setcounter{bottomnumber}{1}
\renewcommand\bottomfraction{.6}
\setcounter{totalnumber}{5}
\renewcommand\textfraction{0}
\renewcommand\floatpagefraction{1}
\addtolength\textheight{\topskip}

\marginparpush 6\p@
\topmargin   .05\paperheight

\setlength\arraycolsep{2\p@}
\setlength\tabcolsep{6\p@}
\setlength\arrayrulewidth{.4\p@}
\setlength\doublerulesep{2\p@}
\setlength\tabbingsep{\labelsep}
\skip\@mpfootins = \skip\footins
\setlength\fboxsep{3\p@}
\setlength\fboxrule{.4\p@}

% No dots in the table of contents
\renewcommand{\@dotsep}{10000}

% Footer and header of the body
% the command ``\pagestyle{myplain}'' must be inserted
% just after ``\begin{document}''
\newcommand\ps@myplain{
\pagenumbering{arabic}
\renewcommand\@oddfoot{\hfill-- \thepage\ --\hfill}
\renewcommand\@oddhead{}}
\let\ps@plain=\ps@myplain



% no header or footer in the title page
\newcommand\ps@titlepage{\renewcommand\@oddfoot{}\renewcommand\@oddhead{}}


% square of norm
\renewcommand{\norm}[1]{\|#1\|}
\newcommand\sqnorm[1]{\norm{#1}^2}


%number equations after the sections
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\numberwithin{equation}{section}


%headings style


\newcommand\psection{\@startsection{section}{1}{\z@}%
                                   {-3.5ex \@plus -1.3ex \@minus -.7ex}%
                                   {2.3ex \@plus .4ex \@minus .4ex}%
                                   {\ }}

\renewcommand\section{\@startsection{section}{1}{\z@}%
                                   {-3.5ex \@plus -1.3ex \@minus -.7ex}%
                                   {2.3ex \@plus .4ex \@minus .4ex}%
                                   {\sffamily\Large\bfseries}}
\renewcommand\subsection{\@startsection{subsection}{2}{\z@}%
                                   {-2.3ex \@plus -1ex \@minus -.5ex}%
                                   {1.2ex \@plus .3ex \@minus .3ex}%
                                   {\sffamily\large\bfseries}}
\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
                                   {-2.3ex \@plus -1ex \@minus -.5ex}%
                                   {1.0ex \@plus .2ex \@minus .2ex}%
                                   {\sffamily\normalsize\bfseries}}
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
                                   {1.75ex \@plus1ex \@minus.2ex}%
                                   {-1em}%
                                   {\sffamily\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{5}{\parindent}%
                                   {1.75ex \@plus1ex \@minus .2ex}%
                                   {-1em}%
                                   {\sffamily\normalsize\bfseries}}


%Caption of figure and table
\def\fnum@figure{\textbf{\figurename\nobreakspace\thefigure}}
\def\fnum@table{\textbf{\tablename\nobreakspace\thetable}}

%redefining \@makecaption, to have captions with \small font size
%taken from article.cls l.489--498
%the only differences are the ``\small '' commands added on two lines
\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{\small #1. #2}%
  \ifdim \wd\@tempboxa >\hsize
    \small #1. #2\par
  \else
    \global \@minipagefalse
    \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}
